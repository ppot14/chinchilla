<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.chinchilla.persistence.mappers.TipoLaborMappers">
    
    <resultMap id="maquinaria-tipo-labor" type="TipoLaborMaquinaria">
        <id property="id_tipo_labor" column="id_tipo_labor"/>
        <id property="posicion_formula" column="posicion_formula"/>
        <result property="multiplicador" column="multiplicador"/>
        <result property="constante" column="constante"/>
        <association property="maquinaria" column="id_t_l_coste_maquinaria" 
                    javaType="com.chinchilla.persistence.objects.Maquinaria" 
                    resultMap="maquinaria"/>
    </resultMap>
      
    <resultMap  id="maquinaria" type="Maquinaria">
        <id property="id_coste_maquinaria" column="id_coste_maquinaria"/>
        <result property="nombre" column="nombre"/>
        <result property="tipo" column="tipo"/>
        <result property="valor_compra" column="valor_compra"/>
        <result property="valor_desecho" column="valor_desecho"/>
        <result property="horas_trabajo" column="horas_trabajo"/>
        <result property="interes" column="interes"/>
        <result property="anyos_mas_1" column="anyos_mas_1"/>
        <result property="reparacion_variable" column="reparacion_variable"/>
        <result property="alojamiento_variable" column="alojamiento_variable"/>
        <result property="prima_seguro" column="prima_seguro"/>
        <result property="cv" column="cv"/>
        <result property="litros_cv_y_hora" column="litros_cv_y_hora"/>
        <result property="horas_cambio_aceite" column="horas_cambio_aceite"/>
        <result property="litros_aceite" column="litros_aceite"/>
    </resultMap>
	
    <select id="getTipoLabor" parameterType="java.lang.Integer" resultType="com.chinchilla.persistence.objects.TipoLabor">
        select 
        id_tipo_labor as "id_tipo_labor",
        nombre as "nombre",
        tipo as "tipo",
        descripcion as "descripcion",
        id_formula as "id_formula"
        from gonzalol_chinchilla.t_tipos_labores 
        where id_tipo_labor = #{id_tipo_labor}
    </select>
	
    <select id="getAllTipoLabor" parameterType="int" resultType="com.chinchilla.persistence.objects.TipoLabor">
        select 
        id_tipo_labor as "id_tipo_labor",
        nombre as "nombre",
        tipo as "tipo",
        descripcion as "descripcion",
        id_formula as "id_formula"
        from gonzalol_chinchilla.t_tipos_labores 
        order by id_tipo_labor
    </select>
	
    <select id="getTipoLaborPorNombre" parameterType="int" resultType="com.chinchilla.persistence.objects.TipoLabor">
        select 
        id_tipo_labor as "id_tipo_labor",
        nombre as "nombre",
        tipo as "tipo",
        descripcion as "descripcion",
        id_formula as "id_formula"
        from gonzalol_chinchilla.t_tipos_labores 
        where nombre = #{nombre}
    </select>
	
    <select id="getAllMapMaquinariaTipoLabor" resultMap="maquinaria-tipo-labor">
        select 	
        id_tipo_labor as "id_tipo_labor",
        tlcm.id_coste_maquinaria as "id_t_l_coste_maquinaria",
        multiplicador as "multiplicador",
        constante as "constante",
        posicion_formula as "posicion_formula",
        cm.id_coste_maquinaria as "id_coste_maquinaria",         
        nombre	as	"nombre"	,
        tipo	as	"tipo"	,
        valor_compra	as	"valor_compra"	,
        valor_desecho	as	"valor_desecho"	,
        horas_trabajo	as	"horas_trabajo"	,
        interes	as	"interes"	,
        anyos_mas_1	as	"anyos_mas_1"	,
        reparacion_variable	as	"reparacion_variable"	,
        alojamiento_variable	as	"alojamiento_variable"	,
        prima_seguro	as	"prima_seguro"	,
        cv	as	"cv"	,
        litros_cv_y_hora	as	"litros_cv_y_hora"	,
        horas_cambio_aceite	as	"horas_cambio_aceite"	,
        litros_aceite	as	"litros_aceite"	
        from gonzalol_chinchilla.t_t_l_costes_maquinaria tlcm
            left join gonzalol_chinchilla.t_costes_maquinaria cm
                on tlcm.id_coste_maquinaria = cm.id_coste_maquinaria
        order by id_tipo_labor, posicion_formula        
    </select>
	
    <insert id="createTipoLabor" keyColumn="id_tipo_labor" useGeneratedKeys="true" parameterType="com.chinchilla.persistence.objects.TipoLabor">
        insert into gonzalol_chinchilla.t_tipos_labores (nombre,tipoo,descripcion,id_formula)
        values (#{nombre},#{tipo},#{descripcion},#{id_formula})		
    </insert>
	
    <update id="updateTipoLabor" parameterType="com.chinchilla.persistence.objects.TipoLabor">
        update gonzalol_chinchilla.t_tipos_labores set nombre = #{nombre},
        tipo = #{tipo},
        descripcion =#{descripcion},
        id_formula = #{id_formula}
        where id_tipo_labor = #{id_tipo_labor}		
    </update>
	
    <delete id="deleteTipoLabor" parameterType="java.lang.Integer">
        delete from gonzalol_chinchilla.t_tipos_labores where id_tipo_labor = #{id_tipo_labor}		
    </delete>
	
	
</mapper>

