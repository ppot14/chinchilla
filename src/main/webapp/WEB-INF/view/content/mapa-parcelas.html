<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<script type="text/javascript" 
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCpAR-D51JR7dd4EXPDxp0j7gUv6kXpSP0&amp;sensor=true&amp;libraries=geometry"></script>
<!--th:src="@{https://maps.googleapis.com/maps/api/js?key=AIzaSyCpAR-D51JR7dd4EXPDxp0j7gUv6kXpSP0(sensor=true)(libraries=geometry)}"></script>-->
<script src="/resources/js/mapas.js" th:src="@{/resources/js/mapas.js}"></script> 

<script th:inline="javascript">/*<![CDATA[*/
  
    $(window).load(function () {
        
//        console.info("Cargando mapa...");  

        var mapOptions = { 
            //CHINCHILLA
            //center: new google.maps.LatLng(37.32637, -5.20889),
            //RANCHO
            //center: new google.maps.LatLng(37.319063,-5.185826),
            center: new google.maps.LatLng(37.328292,-5.215223),
            zoom: 15,
            mapTypeId: google.maps.MapTypeId.SATELLITE  
        };
        
        $('#ir-chinchilla-link').addClass("active");

        var map = new google.maps.Map(document.getElementById("map_canvas"),mapOptions);
        
        var parcelas = /*[[${parcelas}]]*/null;
        var coordenadas = /*[[${coordenadas}]]*/null;
        
//        console.info("parcelas "+parcelas); 
//        console.info("coordenadas "+coordenadas);

        insertarPoligonos(map, parcelas, coordenadas);

//        console.info("Mapa cargado."); 

        $('#ir-chinchilla-link, #ir-rancho-link').click(function (){
            
            var idLink = this.id;
            
            if(idLink === 'ir-chinchilla-link'){
                
               $( this ).addClass("active");
                
               $('#ir-rancho-link').removeClass("active");
                
                map.setCenter(new google.maps.LatLng(37.328292,-5.215223));
                
            }else if(idLink === 'ir-rancho-link'){
                
               $( this ).addClass("active");
                
               $('#ir-chinchilla-link').removeClass("active");
                
                map.setCenter(new google.maps.LatLng(37.319063,-5.185826));
                
            }else{
                
                console.error('Error modificando centro');
                
            }
        });
        
    });
    
/*]]>*/</script> 

<h2 th:text="#{mapa}">Mapa</h2>
<div class="row text-right">
    <div class="btn-group">
        <a id="ir-chinchilla-link" 
           class="btn btn-default btn-sm" href="#">Chinchilla</a>
        <a id="ir-rancho-link" 
           class="btn btn-default btn-sm" href="#">Rancho</a>
    </div>
</div>
<div id="map_canvas" ></div>

</html>
