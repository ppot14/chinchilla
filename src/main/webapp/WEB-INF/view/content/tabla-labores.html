<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<script>/*<![CDATA[*/
  
    $(window).load(function () {
        
        tabla_opciones.aaSorting = [[ 4, "desc" ]];
        
        $.fn.dataTableExt.afnFiltering.push(
            function( oSettings, aData, iDataIndex ) {
//                console.debug('desde '+$( "#fecha_desde" ).val());
//                console.debug('hasta '+$( "#fecha_hasta" ).val());
//                console.debug('fecha_comienzo '+aData[4]);
                var parts_desde = $( "#fecha_desde" ).val()!==""?$( "#fecha_desde" ).val().split('/'):"";
                var parts_hasta = $( "#fecha_hasta" ).val()!==""?$( "#fecha_hasta" ).val().split('/'):"";
                var parts = aData[4].split('/');
                var fecha_comienzo = new Date(parts[2], parts[1]-1, parts[0]);
                var desde = $( "#fecha_desde" ).val()!==""?new Date(parts_desde[2], parts_desde[1]-1, parts_desde[0]):"";
                var hasta = $( "#fecha_hasta" ).val()!==""?new Date(parts_hasta[2], parts_hasta[1]-1, parts_hasta[0]):"";
//                console.debug('desde '+desde);
//                console.debug('hasta '+hasta);
//                console.debug('fecha_comienzo '+fecha_comienzo);
                if ( desde === "" && hasta === "" )
                {
                    return true;
                }
                else if ( desde === "" && fecha_comienzo < hasta )
                {
                    return true;
                }
                else if ( desde < fecha_comienzo && "" === hasta )
                {
                    return true;
                }
                else if ( desde < fecha_comienzo && fecha_comienzo < hasta )
                {
                    return true;
                }
                return false;
            }
        );
    
        var tabla_labores = $('#tabla_labores').dataTable(tabla_opciones);
        
         $( "#fecha_desde" ).datepicker();
         
         $( "#fecha_hasta" ).datepicker();
         
         $( "#fecha_desde" ).on("change", function(){
                tabla_labores.fnDraw(); 
         });
         
         $( "#fecha_hasta" ).on("change", function(){
                tabla_labores.fnDraw(); 
         });
        
    });
    
    
/*]]>*/</script> 
<div class="row" th:inline="text">
    <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
        <h1 class="page-title txt-color-blueDark" ><i class="icon-shovel"></i> [[#{labores}]]</h1>
    </div>
    <div class="col-xs-12 col-sm-5 col-md-5 col-lg-8">
    </div>
</div>

    <!-- widget grid -->
    <section id="widget-grid" class="" th:inline="text">

        <!-- row -->
        <div class="row">

            <!-- NEW WIDGET START -->
            <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

                <!-- Widget ID (each widget will need unique ID)-->
                <div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false"
                                                        data-widget-editbutton="false"
                                                        data-widget-togglebutton="true"
                                                        data-widget-deletebutton="false"
                                                        data-widget-fullscreenbutton="false"
                                                        data-widget-custombutton="false"
                                                        data-widget-collapsed="false" 
                                                        data-widget-sortable="false">
                    <header>
                        <h2><i class="icon-shovel"></i> <strong>[[#{tabla}]]</strong></h2>		
                        <div class="widget-toolbar"> 
                            
                            <a id="anadir-tipo-labor-link" class="btn btn-default btn-sm" 
                                style="display:inline-block" 
                               th:href="@{/labores/tabla/form/labor.html(id=-1)}">
                                 <span class="glyphicon glyphicon-plus"></span> [[#{anadir-labor}]]
                            </a>
                        </div>			
                        <div class="widget-toolbar"> 
                            <!--<div class="input-group">-->
                                <input id="fecha_desde" name="fecha_desde" 
                                        class="input-sx datepicker" 
                                        style="display:inline-block; width: 6em" 
                                       placeholder="Desde"></input> 
<!--                                <span class="input-group-addon"><i class="icon-calendarthree"></i></span>
                            </div>
                            <div class="input-group">-->
                                <input id="fecha_hasta" name="fecha_hasta" 
                                       class="input-sx datepicker" 
                                       style="display:inline-block; width: 6em" 
                                       placeholder="Hasta"></input> 
<!--                                <span class="input-group-addon"><i class="icon-calendarthree"></i></span>
</div>-->			
                        </div>	
                    </header>

                    <!-- widget div-->
                    <div class="no-padding">
                        <!-- widget edit box -->
                        <div class="jarviswidget-editbox">
                        </div>
                        <!-- widget content -->
                        <div class="widget-body">
                            <div class="widget-body-toolbar">

                            </div>
                            
                            <table id="tabla_labores" class="table table-striped table-bordered table-hover table-condensed">
                                <thead>
                                    <tr>
                                      <th>[[#{id-labor}]]</th>
                                      <!--<th>[[#{id-tipo-labor}]]</th>-->
                                      <th>[[#{parcela}]]</th>
                                      <th>[[#{grupo}]]</th>
                                      <th>[[#{nombre}]]</th>
                                      <th>[[#{fecha-comienzo}]]</th>
                                      <!--<th>[[#{cantidad-dosis-por-ha}]]</th>-->
                                      <th>[[#{litros-gasoil}]]</th>
                                      <th>[[#{duracion}]]</th>
                                      <th>[[#{maquinaria}]]</th>
                                      <th>[[#{producto}]]</th>
                                      <th>[[#{personal}]]</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr  th:each="labores_item : ${labores}">
                                      <td><a th:href="@{/labores/tabla/form/labor.html(id=${labores_item.id_labor})}">[[${labores_item.id_labor}]]</a></td>
                                      <!--<td>[[#{labores_item.id_tipo_labor}"><a th:href="@{/labores/tipo/tabla/form/labor.html(id=${labores_item.id_tipo_labor})}" th:text="${labores_item.id_tipo_labor}">[id_tipo_labor]</a></td>-->
                            <!--          <td th:each="tipoLabor_item : ${tiposLabores}" 
                                          th:if="${tipoLabor_item.id_tipo_labor == labores_item.id_tipo_labor}"
                                          th:text="${tipoLabor_item.nombre}">
                                          <a th:href="@{/labores/tipos/tabla/form/tipoLabor.html(id=${labores_item.id_tipo_labor})}" 
                                             th:text="${tipoLabor_item.nombre}">[tipolabor]</a>
                                      </td>-->
                            
                                      <td>
                                        <span  th:each="laborParcela_item : ${labores_item.labor_parcela}"
                                               class="label label-default" ref="#" style="margin-right: 3px">[[${laborParcela_item.parcela.nombre}]]</span>
                                      </td>
                                      <td>[[#{labores_item.grupo}]]</td>
                                      <td>[[#{labores_item.nombre}]]</td>
                                      <td>[[#{#dates.format(labores_item.fecha_comienzo,'dd/MM/yyyy')}]]</td>
                                      <!--<td>[[#{#numbers.formatDecimal(labores_item.cantidad_dosis_por_ha,1,'POINT',0,'COMMA')}]]</td>-->
                                      <td>[[#{#numbers.formatDecimal(labores_item.litros_gasoil,1,'POINT',2,'COMMA')}]]</td>
                                      <td>[[#{#numbers.formatDecimal(labores_item.duracion,1,'POINT',2,'COMMA')}]]</td>
                                      <td>
<!--                                          <ul  th:if="${not #lists.isEmpty(labores_item.labor_maquinaria)}"
                                                class="nav">
                                            <li th:each="laborMaquinaria_item : ${labores_item.labor_maquinaria}">
                                              <a th:text="${laborMaquinaria_item.maquinaria.nombre}" ref="#">[maquinaria]</a>
                                            </li>
                                          </ul>-->
                                          <!--<th:block  th:if="${not #lists.isEmpty(labores_item.labor_maquinaria)}">-->
                                              <!--<div >-->
                                                <span  th:each="laborMaquinaria_item : ${labores_item.labor_maquinaria}"
                                                       class="label label-default" ref="#" style="margin-right: 3px">[[${laborMaquinaria_item.maquinaria.nombre}]]</span>
                                              <!--</div>-->
                                          <!--</th:block>--> 
                                      </td>
                                      <td>
<!--                                          <ul  th:if="${not #lists.isEmpty(labores_item.labor_producto)}"
                                                class="nav">
                                            <li th:each="laborProducto_item : ${labores_item.labor_producto}">
                                              <a th:text="${laborProducto_item.producto.nombre}" ref="#">[producto]</a>
                                            </li>
                                          </ul>-->
                                          
                                          <!--<th:block  th:if="${not #lists.isEmpty(labores_item.labor_producto)}">-->
                                              <!--<div >-->
                                                <span  th:each="laborProducto_item : ${labores_item.labor_producto}"
                                                       class="label label-default" ref="#" style="margin-right: 3px">[[${laborProducto_item.producto.nombre}]]</span>
                                              <!--</div>-->
                                          <!--</th:block>--> 
                                      </td>
                                      <td>
                                          <!--<th:block  th:if="${not #lists.isEmpty(labores_item.labor_personal)}">-->
                                              <!--<div >-->
                                                <span  th:each="laborPersonal_item : ${labores_item.labor_personal}"
                                                    class="label label-default" ref="#" style="margin-right: 3px">[[${laborPersonal_item.coste_personal.tipo}]]</span>
                                              <!--</div>-->
                                          <!--</th:block>--> 
                                      </td>
                                   </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                </div>
            </article>
        </div>
    </section>
</html>